# CLI Interface Contract: git-gone

**Date**: 2025-12-16  
**Feature**: 001-repo-cleanup-tool

## Command Structure

```
git-gone [command] [subcommand] [flags]
```

## Global Flags

| Flag | Short | Type | Default | Description |
|------|-------|------|---------|-------------|
| `--help` | `-h` | bool | false | Show help for command |
| `--version` | `-v` | bool | false | Show version information |

## Commands

### branches (default)

Clean up local branches that are merged or have deleted remotes.

```bash
git-gone branches [flags]
git-gone [flags]           # branches is default command
```

**Flags**:

| Flag | Short | Type | Default | Description |
|------|-------|------|---------|-------------|
| `--force` | `-f` | bool | false | Skip confirmation prompt for safe deletions |
| `--all` | `-a` | bool | false | Select all candidates without interactive selection |
| `--unmerged` | `-u` | bool | false | Include unmerged branches (marked dangerous) |

**Incompatibilities**:
- `-a` and `-f` cannot be used together

**Output (stdout)**:
```
üîÑ Updating remote references...
üìç Default branch: main
üåø Current branch: feature/current

üîç Found 5 deletable branches:
   ‚Ä¢ 3 branches with deleted remotes
   ‚Ä¢ 2 branches merged into main

[Interactive selection UI]

‚ö†Ô∏è  The following branches will be deleted:
  ‚Ä¢ feature/old-1
  ‚Ä¢ feature/old-2

Are you sure you want to delete these branches? (y/N): y

‚úÖ Deleted branch: feature/old-1
‚úÖ Deleted branch: feature/old-2

üéâ Successfully deleted 2 branches
```

**Exit Codes**:
- `0`: Success (branches deleted or none to delete)
- `1`: Error (not a git repo, deletion failed, etc.)

---

### tags

Manage local tags.

```bash
git-gone tags [subcommand] [flags]
```

#### tags list

List local tags that don't exist on remote.

```bash
git-gone tags list
```

**Output (stdout)**:
```
üìã Stale tags (not on remote):
  ‚Ä¢ v0.0.1-beta
  ‚Ä¢ test-tag

Found 2 stale tags
```

#### tags clean

Interactively clean stale tags.

```bash
git-gone tags clean [flags]
```

**Flags**:

| Flag | Short | Type | Default | Description |
|------|-------|------|---------|-------------|
| `--force` | `-f` | bool | false | Skip confirmation prompt |
| `--all` | `-a` | bool | false | Select all without interaction |

**Output (stdout)**:
```
üîÑ Fetching remote tags...

üîç Found 2 stale tags:
  ‚Ä¢ v0.0.1-beta
  ‚Ä¢ test-tag

[Interactive selection UI]

‚ö†Ô∏è  The following tags will be deleted:
  ‚Ä¢ v0.0.1-beta

Are you sure? (y/N): y

‚úÖ Deleted tag: v0.0.1-beta

üéâ Successfully deleted 1 tag
```

---

### version

Show version information.

```bash
git-gone version
```

**Output (stdout)**:
```
git-gone version 0.3.0
  Commit: abc1234
  Built:  2025-12-16T10:00:00Z
```

---

### self-update

Update to the latest version from GitHub releases.

```bash
git-gone self-update [flags]
```

**Flags**:

| Flag | Short | Type | Default | Description |
|------|-------|------|---------|-------------|
| `--check` | `-c` | bool | false | Only check for updates, don't install |

**Output (check mode)**:
```
üîç Checking for updates...
üì¶ Current version: 0.3.0
üÜï Latest version:  0.4.0

Update available! Run 'git-gone self-update' to install.
```

**Output (update mode)**:
```
üîç Checking for updates...
üì¶ Current version: 0.3.0
üÜï Latest version:  0.4.0

‚¨áÔ∏è  Downloading git-gone v0.4.0...
‚úÖ Updated successfully!

Restart your terminal or run 'git-gone version' to verify.
```

---

### help

Auto-generated by Cobra.

```bash
git-gone help [command]
git-gone [command] --help
```

---

### completion

Auto-generated by Cobra. Produces shell completion scripts.

```bash
git-gone completion bash
git-gone completion zsh
git-gone completion fish
git-gone completion powershell
```

## Error Messages

All errors written to stderr with ‚ùå prefix:

```
‚ùå Not in a git repository
‚ùå Failed to fetch remote: network error
‚ùå Options -a (--all) and -f (--force) are incompatible
‚ùå Branch deletion failed: feature/protected is protected
```

## Interactive Elements

### Selection UI

Uses fuzzy finder with multi-select:

```
Select branches to delete > _
> [ ] feature/old-1
  [ ] feature/old-2
  [‚úì] feature/old-3

‚Üë/‚Üì: Navigate | Tab: Select | Enter: Confirm | Esc: Cancel
```

### Dangerous Confirmation

For unmerged branches (with `-u` flag):

```
üö® WARNING: You are about to delete 1 UNMERGED branch(es):
   ‚Ä¢ feature/work-in-progress (will be deleted locally AND from remote)

‚ö†Ô∏è  This action cannot be undone! Type 'DELETE' to confirm: _
```

## Environment Variables

| Variable | Description |
|----------|-------------|
| `GIT_GONE_NO_COLOR` | Disable colored output |
| `GIT_GONE_NO_EMOJI` | Disable emoji in output |
| `LC_ALL` | Set to `C` internally for git command parsing |

